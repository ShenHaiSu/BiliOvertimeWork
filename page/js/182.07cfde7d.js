"use strict";(self["webpackChunkbili_overtime_work_frontend"]=self["webpackChunkbili_overtime_work_frontend"]||[]).push([[182],{182:function(t,e,o){o.r(e),o.d(e,{default:function(){return u}});var s=function(){var t=this,e=t._self._c;return e("b-container",{attrs:{fluid:"",id:"OutContainer"}},[e("hr"),e("b-container",[e("h1",[e("b",[t._v("加班组件")]),e("small",[e("b-badge",[t._v("v0.1 配置面板")])],1)]),e("hr"),e("b-row",[e("b-col",[e("b-btn",{on:{click:t.getBaseInfo}},[t._v("刷新面板信息")])],1),e("b-col",[e("b-btn",{attrs:{variant:"primary"},on:{click:t.openOBSView}},[t._v("打开OBS显示窗口")])],1),e("b-col",[e("b-btn",{attrs:{variant:"primary"},on:{click:t.copyOBSViewAddress}},[t._v("复制OBS显示窗口网址")])],1),e("b-col",[e("b-btn",{attrs:{variant:"danger"},on:{click:t.resetTimeLeft}},[t._v("重置剩余加班时间")])],1)],1),e("hr"),e("h3",[t._v("基础信息")]),e("br"),e("b-row",[e("b-col",{attrs:{cols:"2"}},[e("span",{staticClass:"baseText"},[t._v("默认加班时间")])]),e("b-col",{attrs:{cols:"10"}},[e("span",{staticClass:"baseText"},[t._v(t._s(t._f("timeFormat")(this.defaultWorkTime)))])])],1),e("b-row",[e("b-col",{attrs:{cols:"2"}},[e("span",{staticClass:"baseText"},[t._v("当前剩余加班时间")])]),e("b-col",{attrs:{cols:"10"}},[e("span",{staticClass:"baseText"},[t._v(t._s(t._f("timeFormat")(this.currentWorkTime)))])])],1),e("br"),e("br"),e("hr"),e("h3",[t._v("快捷操作")]),e("br"),e("b-row",[e("b-col",{attrs:{cols:"2"}},[e("span",{staticClass:"baseText"},[t._v("修改量")])]),e("b-col",{attrs:{cols:"8"}},[e("b-input",{attrs:{placeholder:"填入需要修改加班时间的量，正数增加，负数减少。(单位：秒)",type:"number"},model:{value:t.fastModCount,callback:function(e){t.fastModCount=e},expression:"fastModCount"}})],1),e("b-col",[e("b-btn",{attrs:{variant:"primary"},on:{click:t.fastModTime}},[t._v("提交更改")])],1)],1),e("br"),e("br"),e("hr"),e("h3",[t._v("礼物修改时间列表")]),e("br"),e("b-row",[e("b-col",{directives:[{name:"b-popover",rawName:"v-b-popover.hover.bottom",value:"如果有两笔数据的礼物名相同，那么序号较小的优先触发，序号较大的将不会触发。",expression:"'如果有两笔数据的礼物名相同，那么序号较小的优先触发，序号较大的将不会触发。'",modifiers:{hover:!0,bottom:!0}}],attrs:{cols:"1",title:"配置的序号"}},[t._v("序号 ")]),e("b-col",{directives:[{name:"b-popover",rawName:"v-b-popover.hover.bottom",value:"只允许填入字符串。需要和真实礼物名完全一一对应。",expression:"'只允许填入字符串。需要和真实礼物名完全一一对应。'",modifiers:{hover:!0,bottom:!0}}],attrs:{cols:"2",title:"触发的礼物名"}},[t._v("礼物名 ")]),e("b-col",{directives:[{name:"b-popover",rawName:"v-b-popover.hover.bottom",value:"允许的类型仅有五个，分别是增加、减少、乘以、除以和N次方。",expression:"'允许的类型仅有五个，分别是增加、减少、乘以、除以和N次方。'",modifiers:{hover:!0,bottom:!0}}],attrs:{cols:"2",title:"触发事件的类型"}},[t._v("类型 ")]),e("b-col",{directives:[{name:"b-popover",rawName:"v-b-popover.hover.bottom",value:"指时间变动触发事件所需要的礼物数量，如果低于这个数量，仅会将数据累加，直到超过阈值。",expression:"'指时间变动触发事件所需要的礼物数量，如果低于这个数量，仅会将数据累加，直到超过阈值。'",modifiers:{hover:!0,bottom:!0}}],attrs:{cols:"2",title:"触发事件的阈值"}},[t._v("阈值 ")]),e("b-col",{directives:[{name:"b-popover",rawName:"v-b-popover.hover.bottom",value:"必须填入大于0的整数。如果触发类型是N次方，那么次数变化量代表次方数。例如2代表平方。",expression:"'必须填入大于0的整数。如果触发类型是N次方，那么次数变化量代表次方数。例如2代表平方。'",modifiers:{hover:!0,bottom:!0}}],attrs:{cols:"4",title:"触发事件后加班时间的变化量"}},[t._v("变化量 ")]),e("b-col",{directives:[{name:"b-popover",rawName:"v-b-popover.hover.bottom",value:"点击按钮对指定行的数据进行操作，如果需要重置可以点击界面上方的 刷新面板信息 ",expression:"'点击按钮对指定行的数据进行操作，如果需要重置可以点击界面上方的 刷新面板信息 '",modifiers:{hover:!0,bottom:!0}}],attrs:{cols:"1",title:"对单笔数据进行操作"}},[t._v("操作 ")])],1),e("br"),0===t.modList.length?[e("b-badge",[t._v("列表为空")]),e("br")]:t._e(),t._l(t.modList,(function(o,s){return[e("b-row",{key:s+"no",staticClass:"DataRow"},[e("b-col",{attrs:{cols:"1"}},[t._v(t._s(s+1))]),e("b-col",{attrs:{cols:"2"}},[e("b-input",{model:{value:o.giftName,callback:function(e){t.$set(o,"giftName",e)},expression:"item.giftName"}})],1),e("b-col",{attrs:{cols:"2"}},[e("b-select",{attrs:{options:t.modOptionsList},model:{value:o.type,callback:function(e){t.$set(o,"type",e)},expression:"item.type"}})],1),e("b-col",{attrs:{cols:"2"}},[e("b-input",{attrs:{type:"number"},model:{value:o.count,callback:function(e){t.$set(o,"count",t._n(e))},expression:"item.count"}})],1),e("b-col",{attrs:{cols:"4"}},[e("b-input",{attrs:{type:"number"},model:{value:o.timeChange,callback:function(e){t.$set(o,"timeChange",t._n(e))},expression:"item.timeChange"}})],1),e("b-col",{attrs:{cols:"1"}},[e("b-btn",{attrs:{variant:"danger"},on:{click:function(e){return t.deleteItem(s)}}},[t._v("删除")])],1)],1)]})),e("br"),e("b-row",[e("b-col",[e("b-btn",{staticStyle:{width:"50%"},on:{click:t.addNewModItem}},[t._v("新增一笔数据")])],1),e("b-col",[e("b-btn",{staticStyle:{width:"50%"},attrs:{variant:"primary"},on:{click:t.uploadModList}},[t._v("上传列表")])],1),e("b-col",[e("b-btn",{staticStyle:{width:"50%"},attrs:{variant:"danger"},on:{click:t.getBaseInfo}},[t._v("重置列表")])],1)],1)],2),e("br"),e("br"),e("br"),e("br"),e("br")],1)},r=[],a=o(9669),i=o.n(a),n=o(289),l=o(8175),c=o.n(l),b={name:"OvertimeWorkConfig",data(){return{defaultWorkTime:7200,currentWorkTime:200,modList:[],tempGiftList:[],fastModCount:null,modOptionsList:[{value:"add",text:"增加"},{value:"reduce",text:"减少"},{value:"multi",text:"乘以"},{value:"division",text:"除以"},{value:"power",text:"N次方"}],OBSViewAddress:"/OBSView/overtimeWork"}},methods:{async resetTimeLeft(){if(!window.confirm("确定要将当前剩余加班时间删除，并设置为默认加班时间吗？"))return;let t=await this.sendRequest("/API/overtimeWork/resetTime","post");t.err||(n.C.call(this,"重置时间成功","已经将剩余加班时间重置为默认时间。","success"),this.getBaseInfo().then())},async getBaseInfo(){let t=await this.sendRequest("/API/overtimeWork/getInfo","get");t.err||(this.defaultWorkTime=t.data.defaultWorkTime,this.currentWorkTime=t.data.currentWorkTime,this.modList=t.data.modList,this.tempGiftList=t.data.tempGiftList,this.$forceUpdate())},async fastModTime(){if(!this.fastModCount)return n.C.call(this,"参数不符合要求","快捷操作量必须是正负整数。","danger");let t=await this.sendRequest("/API/overtimeWork/fastMod","post",{modCount:parseInt(this.fastModCount)});t.err||(n.C.call(this,"快捷操作修改完毕。","操作修改完毕，如果剩余加班时间没有变动，请尝试点击刷新信息按钮。","success"),this.getBaseInfo().then())},async uploadModList(){if(!window.confirm("请确认数据是否合规，上传后核心将会自动删除不合规的数据。并不保留不合规数据。"))return;let t=await this.sendRequest("/API/overtimeWork/updateModList","post",this.modList);t.err||n.C.call(this,"上传数据已完成","如果列表没有刷新，可以点击 '重置列表' 获取当前最新可用的列表","success")},openOBSView(){open("http://"+location.host+"/#"+this.OBSViewAddress)},copyOBSViewAddress(){c().copy("http://"+location.host+"/#"+this.OBSViewAddress),n.C.call(this,"内容已复制","http://"+location.host+"/#"+this.OBSViewAddress,"success")},deleteItem(t){this.modList.splice(t,1)},addNewModItem(){this.modList.push({giftName:"空白",count:0,timeChange:0,type:"add"})},testData(){console.log(this.modList)},sendRequest(t,e="get",o={}){return i()({url:t,method:e,data:o}).then((t=>({err:!1,data:t.data}))).catch((t=>(n.C.call(this,"请求失败",t.message,"danger"),{err:!0})))}},mounted(){this.getBaseInfo(),setInterval((()=>{this.currentWorkTime<=0||!this.$store.state.liveStatus||this.currentWorkTime--}),1e3),this.$EventBus.$on("OvertimeWork-changeTime",(t=>{t=JSON.parse(t),this.currentWorkTime=t["timeLeft"]})),this.$EventBus.$on("OvertimeWork-changeModList",(t=>{t=JSON.parse(t),this.modList=t["data"]}))},filters:{timeFormat(t){let e="";return e+=Math.floor(t/86400)+"天 ",t-=86400*Math.floor(t/86400),e+=Math.floor(t/3600)+"小时 ",t-=3600*Math.floor(t/3600),e+=Math.floor(t/60)+"分钟 ",t-=60*Math.floor(t/60),e+=Math.floor(t)+"秒",e}}},m=b,d=o(1001),v=(0,d.Z)(m,s,r,!1,null,"068f583a",null),u=v.exports}}]);
//# sourceMappingURL=182.07cfde7d.js.map